#CVE-2023-5504 #BackWPup – WordPress Backup Plugin #backwpup

from bs4 import BeautifulSoup
import re
import requests
import sys
import urllib3

urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
requests.adapters.DEFAULT_RETRIES = 2
n = len(sys.argv)

x = '''

░█████╗░██╗░░░██╗███████╗░░░░░░██████╗░░█████╗░██████╗░██████╗░░░░░░░███████╗███████╗░█████╗░░░██╗██╗
██╔══██╗██║░░░██║██╔════╝░░░░░░╚════██╗██╔══██╗╚════██╗╚════██╗░░░░░░██╔════╝██╔════╝██╔══██╗░██╔╝██║
██║░░╚═╝╚██╗░██╔╝█████╗░░█████╗░░███╔═╝██║░░██║░░███╔═╝░█████╔╝█████╗██████╗░██████╗░██║░░██║██╔╝░██║
██║░░██╗░╚████╔╝░██╔══╝░░╚════╝██╔══╝░░██║░░██║██╔══╝░░░╚═══██╗╚════╝╚════██╗╚════██╗██║░░██║███████║
╚█████╔╝░░╚██╔╝░░███████╗░░░░░░███████╗╚█████╔╝███████╗██████╔╝░░░░░░██████╔╝██████╔╝╚█████╔╝╚════██║
░╚════╝░░░░╚═╝░░░╚══════╝░░░░░░╚══════╝░╚════╝░╚══════╝╚═════╝░░░░░░░╚═════╝░╚═════╝░░╚════╝░░░░░░╚═╝
'''

print(x)

target = sys.argv[1]
target = target+"/wp-content/plugins/backwpup/readme.txt"

try:
    response = requests.get(f"{target}",verify=False)
    if response.status_code == 200:
        soup = BeautifulSoup(response.text,'html.parser')
        s = str(soup)
        version = re.search(r'= (\d+).(\d+).(\d+) =',s)
        if version:
            v = version.group()
            x1 = v.split(" ")
            x2 = x1[1].split('.')
            x3 = int(x2[0])
            x4 = int(x2[1])
            x5 = int(x2[2])
            if x3 <= 4 and x4 <=0 and x5 < 2:
                print('Found Following Version for Plugin BackWPup – WordPress Backup Plugin: '+str(x3)+'.'+str(x4)+'.'+str(x5)+' Which appears to be vulnerable to CVE-2023-5504')
            else:
                print('Found Following Version for Plugin BackWPup – WordPress Backup Plugin: '+str(x3)+'.'+str(x4)+'.'+str(x5)+' Which does not appears to be vulnerable to CVE-2023-5504')
        else:
            print("Script Does not able to find Version for Plugin BackWPup – WordPress Backup Plugin, Check Manually")
    else:
        print("Server Not Available",response.status_code)
except Exception as e:
    print("Please Check URL",e)

